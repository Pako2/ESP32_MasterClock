var version = "";
var netwmax = 16;
var websock = null;
var heartbeat_msg = '--heartbeat--', heartbeat_interval = null, missed_heartbeats = 0;
var wsUri = "ws://" + window.location.host + "/ws";
var utcSeconds;
var tzoffset;
var sl_mode=0;//0-stopped,  1-waiting, 2-accelerated catch-up, 3-running, 4-even voltage, 5-odd voltage
var SL_MODES=Array("Stopped","Waiting", "Accelerated catch-up", "Running", "Even voltage", "Odd voltage");
var newtime="000000";
var sl_hour=0;
var sl_min=0;
//var data = [];
var ajaxobj;
var netw = {"ipaddress": "", "subnet": "", "gateway": "", "dnsadd": "", "dhcp": 1};
var ipdict = {"ipaddress": "IP Address", "subnet": "Mask", "gateway": "Gateway", "dnsadd": "DNS Server"};
var GPIOS = [0,1,2,3,4,5,6,7,8,9,10];//
var RESERVEDGPIOS=[];
var config = {
	"command": "configfile",
	"network": {
    "apssid": "ESP32_MasterClock",
    "apaddress": "192.168.4.1",
    "apsubnet": "255.255.255.0",
    "networks": []
	},
	"hardware": {
		"evenpin": 255,
		"oddpin": 255,
		"wifipin": 8,
		"rgbpin": 255,
		"wifiledon": 0,
		"brghtnss":16
},
	"general": {
	  "psswd": "admin",
		"hostnm": "ESP32_MasterClock"
	},
	"ntp": {
		"server": "pool.ntp.org",
		"interval": 30,
		"timezone": "CET-1CEST,M3.5.0,M10.5.0/3",
		"tzname": "Europe/Prague"
	},
  "clock": {
    "cycle": 12,
    "linetype": 60,
    "plength": 8,
    "glength": 8
  }
};

var backupstarted = false;
var restorestarted = false;
var gotInitialData = false;
var wsConnectionPresent = false;

var esp32masterclock;

var clock_face = new Image();
clock_face.src = "data:image/png;base64,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rCzKxOfEUZ0uSPzIdcnhN84lm708M6xn0/PEYWKh1MVSF7OyrhBPE0dkRaV8b85hmfMWZ6VaZ+178hcGC+pKhus0R5HAEpJIQYCEOiqowkSMVpUUA2naj7v4R2x/ilwSuSpg5FhADQpE2w/+B7+7NYpTk05SMA70vFjWxxgQ2AVaDcv6Pras1gngewau1I6/1gRmP0lvdLTIEdC/DVxcdzRpD7jcAYafNFEXbclH01ssAu9n9E15YOAW6Ftzemvv4/QByFJXyzfAwSEwXqLsdZd393b39u+Zdn8/mD5ytse5ZL4AAA3haVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIKICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgIHhtbG5zOkdJTVA9Imh0dHA6Ly93d3cuZ2ltcC5vcmcveG1wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjc5RTI3RkFBQkQzRjExRTE5MzIwOEE2M0RBRERFQTQ3IgogICB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjYyNjI4N2YxLWNjNDYtNGFlYy05YTRiLTcyNGRjNTQyNjY4MSIKICAgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOkQ0RUUwQkU1OTZCQ0UxMTFBQTE4REE0MUI2QTY5MjM0IgogICBkYzpGb3JtYXQ9ImltYWdlL3BuZyIKICAgR0lNUDpBUEk9IjIuMCIKICAgR0lNUDpQbGF0Zm9ybT0iV2luZG93cyIKICAgR0lNUDpUaW1lU3RhbXA9IjE3MTM3MTMwNTc5MjE4OTMiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4yOCIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiPgogICA8eG1wTU06SGlzdG9yeT4KICAgIDxyZGY6U2VxPgogICAgIDxyZGY6bGkKICAgICAgc3RFdnQ6YWN0aW9uPSJzYXZlZCIKICAgICAgc3RFdnQ6Y2hhbmdlZD0iLyIKICAgICAgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo2NTUyYWE5MC0wNjUyLTQwYjItYmM4Yi04NWFjNjliMmM5NjMiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkdpbXAgMi4xMCAoV2luZG93cykiCiAgICAgIHN0RXZ0OndoZW49IjIwMjQtMDQtMjFUMTc6MjQ6MTciLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogICA8eG1wTU06RGVyaXZlZEZyb20KICAgIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RDRFRTBCRTU5NkJDRTExMUFBMThEQTQxQjZBNjkyMzQiCiAgICBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkQ0RUUwQkU1OTZCQ0UxMTFBQTE4REE0MUI2QTY5MjM0Ii8+CiAgPC9yZGY6RGVzY3JpcHRpb24+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz5QBnoYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH6AQVDxgRR3PNtAAAIABJREFUeNrtfXd4FWX2/51yS25LD2mkEEINLSQRkBZdCEUBUYooCsq6sCCsIPxWhWdtX5cHUMG2gNJBpLuKFEERNoAgLlVaQnpyQ+q9ub3N/P5419nZuXfOzC1Jrj45f/hI7sz7fua85z3vec973nMwmqYlHdRBHdRBHfT7IryDBR3UQR3UQb8/Itn/oCjKbDZbrVa32912ywuOy+VylUollUq9PuB2u81ms81ma2NUCoVCpVKRJOn1AZfLhVBRFNVmqAiCQKgIgvD6gNPpNJvNdru9jVGFhYUplUo+VA6Hw2w2OxyOtkRFkiRChePeLRi73Y5QtdnmFcMwgiCUSqVSqcQwzOszNpvNbDY7nc62REWSpFKpDAsL40NltVrNZrPL5WpLVFKpVKlUKhQKr6homrZarRaLpe1RqVQqhULh9QGapi0Wi8VicbvdbYlKJpOpVCq5XP4/f2cQ2O32pqamtlSgHHxqtVqr1XIG0mq1Njc3t6VS4KDSarVqtZqDymw26/X69vJo4TgeHh6uUqk4fzeZTAaDob1QEQQRERERFhbGkXWj0djS0tJuxgtJRkREcKYiTdMGg8FkMrUXKqlUGhkZKZPJOKaVXq+3WCzthUomk0VGRnJsLLfb3dzcbLPZ2guVXC6PjIzk2Fgul6upqcnhcLQXqrCwsIiICI4143Q6m5qanE5ne6FSKpURERGMNfMf5e50Opubm9vd/y6XyyMiIti2VTtqK/ZAarVatm3V0tLSvqhomlar1Wq1mvmLxWIxGo3tyyiaprVarVKpZK83ZrO53VFx9HtLS4vVam13VFFRUYx+R+uN3W5v9718dHQ0o0lpmm5ubm5HbcXYWNHR0YwmpSiqubnZ5XK1Lyocx6OjoxlN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";

//clock1
var canvas;
var ctx;
var radius;
//clock2
var canvas2;
var ctx2;
var radius2;

// define a function that converts a string to hex
var stringToHex = (str) => {
  var hex = '';
  for (var i = 0; i < str.length; i++) {
    var charCode = str.charCodeAt(i);
    var hexValue = charCode.toString(16);

    // Pad with zeros to ensure two-digit representation
    hex += hexValue.padStart(2, '0');
  }
  return hex;
};

// clock begin

function drawDigit(cx,time,sec)
{
    var IMG_HEIGHT = 86,
	IMG_WIDTH = 455,
	DIGIT_HEIGHT = IMG_HEIGHT,
	DIGIT_WIDTH = 50,
	iHHMMGap = 10;
  var xPositions = Array(DIGIT_WIDTH * 0,
							DIGIT_WIDTH * 1,
							(DIGIT_WIDTH * 2) + iHHMMGap,
							(DIGIT_WIDTH * 3) + iHHMMGap);
  	// Draw the HHHH digits onto the canvas
	for(i = 0; i < 4; i++) {
    cx.drawImage(clock_face, time.substr(i,1) * DIGIT_WIDTH, 0, DIGIT_WIDTH, DIGIT_HEIGHT, xPositions[i], 0, DIGIT_WIDTH, DIGIT_HEIGHT);
	}
	if (sec)
	{
    var	iSSGap = 5;
    var	secondWidth = DIGIT_WIDTH * 0.5;
    var	secondHeight = DIGIT_HEIGHT * 0.5;
    var	xSecondStartPos = xPositions[3] + DIGIT_WIDTH + iSSGap;
	  cx.drawImage(clock_face, time.substr(4, 1) * DIGIT_WIDTH, 0, DIGIT_WIDTH, DIGIT_HEIGHT, xSecondStartPos, 0, secondWidth, secondHeight);
	  cx.drawImage(clock_face, time.substr(5, 1) * DIGIT_WIDTH, 0, DIGIT_WIDTH, DIGIT_HEIGHT, xSecondStartPos + secondWidth, 0, secondWidth, secondHeight);
  }
}


function drawFace(cx, rds) {
  var grad = cx.createRadialGradient(0,0,rds*0.95, 0,0,rds*1.05);
  grad.addColorStop(0, '#333');
  grad.addColorStop(0.5, 'white');
  grad.addColorStop(1, '#333');
  cx.beginPath();
  cx.arc(0, 0, rds, 0, 2*Math.PI);
  cx.fillStyle = 'white';
  cx.fill();
  cx.strokeStyle = grad;
  cx.lineWidth = rds*0.1;
  cx.stroke();
  cx.beginPath();
  cx.arc(0, 0, rds*0.1, 0, 2*Math.PI);
  cx.fillStyle = '#333';
  cx.fill();
}

function drawNumbers(cx, rds) {
  cx.font = rds*0.15 + "px arial";
  cx.textBaseline="middle";
  cx.textAlign="center";
  for(var num = 1; num < 13; num++){
    var ang = num * Math.PI / 6;
    cx.rotate(ang);
    cx.translate(0, -rds*0.85);
    cx.rotate(-ang);
    cx.fillText(num.toString(), 0, 0);
    cx.rotate(ang);
    cx.translate(0, rds*0.85);
    cx.rotate(-ang);
  }
}

function drawTime(cx, rds, time, sec){
    var hour = parseInt(time.substr(0,2));
    var minute = parseInt(time.substr(2,2));
    var second = parseInt(time.substr(4,2));
    //hour
    hour=hour%12;
    hour=(hour*Math.PI/6)+
    (minute*Math.PI/(6*60))+
    (second*Math.PI/(360*60));
    drawHand(cx, hour, rds*0.5, rds*0.07);
    //minute
    minute=(minute*Math.PI/30)+(second*Math.PI/(30*60));
    drawHand(cx, minute, rds*0.8, rds*0.07);
    // second
    if (sec)
    {
    second=(second*Math.PI/30);
    drawHand(cx, second, rds*0.9, rds*0.02);
    }
}

function drawHand(cx, pos, length, width) {
    cx.beginPath();
    cx.lineWidth = width;
    cx.lineCap = "round";
    cx.moveTo(0,0);
    cx.rotate(pos);
    cx.lineTo(0, -length);
    cx.stroke();
    cx.rotate(-pos);
}

function updateTime(time)
{
  if (config.clock.cycle===12)
  {
    drawAnalog(ctx, radius, time, true);
  }
  else
  {
    drawDigit(ctx, time, true);
  }
}

function slclock()
{
  var time=String(sl_hour).padStart(2, '0')+String(sl_min).padStart(2, '0')+"00";
  if (config.clock.cycle===12)
  {
    drawAnalog(ctx2, radius2, time, false);
  }
  else
  {
    drawDigit(ctx2, time, false);
  }  
}

function slhour(hr)
{
  sl_hour+=hr;
  if (sl_hour===config.clock.cycle)
  {
    sl_hour=0;
  }
  if (sl_hour===-1)
  {
    sl_hour=config.clock.cycle-1;
  }
  slclock();
}

function slmin(mn)
{
  hr=0;
  sl_min+=mn;
  if (sl_min===60)
  {
    sl_min=0;
    hr=1;
  }
  if (sl_min===-1)
  {
    sl_min=59;
    hr=-1;
  }
  slhour(hr);
}

function browserTime() {

	var d = new Date(0);
	var c = new Date();
	var timestamp = Math.floor((c.getTime() / 1000) + ((c.getTimezoneOffset() * 60) * -1));
	d.setUTCSeconds(timestamp);
	document.getElementById("rtc").innerHTML = d.toUTCString().slice(0, -3);
}

function deviceTime() {
	var t = new Date(0); // The 0 there is the key, which sets the date to the epoch,
	var devTime = Math.floor(utcSeconds + (tzoffset * 60));
	t.setUTCSeconds(devTime);
	document.getElementById("utc").innerHTML = t.toUTCString().slice(0, -3);
}

function syncBrowserTime() {
	var d = new Date();
	var timestamp = Math.floor((d.getTime() / 1000));
	var datatosend = {};
	datatosend.command = "settime";
	datatosend.epoch = timestamp;

	var select = document.getElementById("DropDownTimezone");
	config.ntp.tzname = select.options[select.selectedIndex].text;
	config.ntp.timezone = select.value;

	datatosend.timezone = config.ntp.timezone;
	sendMessage(JSON.stringify(datatosend));
	$("#ntp").click();
}

function saveJSON(data, anchorElement, filename){
    data = JSON.stringify(data, null, 2);
    var blob = new Blob([data], {type: 'application/json;charset=utf-8'}),
        e    = document.createEvent('MouseEvents'),
        a = document.getElementById(anchorElement);
    a.download = filename;
    a.href = window.URL.createObjectURL(blob);
    a.dataset.downloadurl =  ['application/json;charset=utf-8', a.download, a.href].join(':');
    e.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
    a.dispatchEvent(e);
}

function backupset() {
	saveJSON(config, "downloadSet", "esp32_masterclock-settings.json");
}

function createOptions(slct, input, reserv=false)
{
  slct.children().remove();
  slct.append($("<option>").attr('value',255).text("None"));
  $(GPIOS).each(function()
  {
    if (!RESERVEDGPIOS.includes(parseInt(this)) || reserv)
    {
      slct.append($("<option>").attr('value',this).text(["GPIO-",String(this).padStart(2, '0')].join('')));
    }
  });
}


function listhardware() {
	var evensel = $('#evenpin');
	createOptions(evensel, false);
	evensel.val(config.hardware.evenpin);
	var oddsel = $('#oddpin');
	createOptions(oddsel, false);
	oddsel.val(config.hardware.oddpin);
	var wifisel = $('#wifipin');
	createOptions(wifisel, false, true);
	wifisel.val(config.hardware.wifipin);
	var rgbsel = $('#rgbpin');
	createOptions(rgbsel, false, true);
	rgbsel.val(config.hardware.rgbpin);
	$('#wifiledon'+config.hardware.wifiledon.toString()).prop('checked', true);
	document.getElementById("brghtnss").value = config.hardware.brghtnss.toString();
	document.getElementById("brghtnss2").innerText = config.hardware.brghtnss.toString();

}

function savehardware() {
	config.hardware.evenpin = parseInt($("#evenpin").val());
	config.hardware.oddpin = parseInt($("#oddpin").val());
	config.hardware.wifipin = parseInt($("#wifipin").val());
	config.hardware.rgbpin = parseInt($("#rgbpin").val());
	config.hardware.wifiledon = parseInt(	$(':radio[name="wifiledon"]:checked').val());
	config.hardware.brghtnss = parseInt(document.getElementById("brghtnss").value);
	uncommited();
}

function listntp() {
	sendMessage("{\"command\":\"gettime\"}");
	document.getElementById("ntpserver").value = config.ntp.server;
	document.getElementById("intervals").value = config.ntp.interval;
	var select = document.getElementById("DropDownTimezone");
	for (var option of select.options) {
		if (option.text === config.ntp.tzname) {
			option.selected = true;
			break;
		}
	}
	browserTime();
	deviceTime();
}

function revcommit() {
	document.getElementById("jsonholder").innerText = JSON.stringify(config, null, 2);
	$("#revcommit").modal("show");
}

function uncommited() {
	$("#commit").fadeOut(200, function() {
		$(this).css("background", "gold").fadeIn(1000);
	});
	document.getElementById("commit").innerHTML = "<h6>You have uncommited changes, please click here to review and commit.</h6>";
	$("#commit").click(function() {
		revcommit();
		return false;
	});
}

function listclock()
{
  $('#linetype'+config.clock.linetype.toString()).prop('checked', true);
  $('#cycle'+config.clock.cycle.toString()).prop('checked', true);
  $('#plength').val(config.clock.plength/10);
  $('#plength2').html((config.clock.plength/10).toFixed(1)+"s");
  $('#glength').val(config.clock.glength/10);
  $('#glength2').html((config.clock.glength/10).toFixed(1)+"s");
}

function pulselength(val)
{
  $('#plength').val(val);
  $('#plength2').html(parseFloat(val).toFixed(1)+"s");
}

function brightness(val)
{
  $('#brghtnss').val(val);
  $('#brghtnss2').html(parseInt(val));
  
}

function gaplength(val)
{
  $('#glength').val(val);
  $('#glength2').html(parseFloat(val).toFixed(1)+"s");
}

function saveclock() {
    config.clock.linetype = parseInt(	$(':radio[name="linetype"]:checked').val());
    config.clock.cycle = parseInt(	$(':radio[name="cycle"]:checked').val());
    config.clock.plength = 10*($('#plength').val());
    config.clock.glength = 10*($('#glength').val());
    uncommited();
}


function saventp() {
	config.ntp.server = document.getElementById("ntpserver").value;
	config.ntp.interval = parseInt(document.getElementById("intervals").value);
	var select = document.getElementById("DropDownTimezone");
	config.ntp.tzname = select.options[select.selectedIndex].text;
	config.ntp.timezone = select.value;
	uncommited();
}

function savegeneral() {
	var a = document.getElementById("adminpwd").value;
	if (a === null || a === "") {
		alert("Administrator Password cannot be empty");
		return;
	}
	config.general.psswd = btoa(a);
	config.general.hostnm = document.getElementById("hostname").value;
	uncommited();
}


function checkOctects(input) {
	var ipformat = /^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;
	var call = document.getElementById(input);
	if (call.value.match(ipformat)) {
		return true;
	} else {
		alert("You have entered an invalid IP address on the field \"" + ipdict[input]+"\"");
		call.focus();
		return false;
	}
}

function savenetwork()
{
  config.network.apssid=$('#apssid').val();
  config.network.apaddress=$('#apaddress').val();
  config.network.apsubnet=$('#apsubnet').val();
  
  config.network.networks = JSON.parse(JSON.stringify(readNetwTable()));//deep copy

  for (i = 0; i < config.network.networks.length; i++) {
    config.network.networks[i].wifipass=btoa(config.network.networks[i].wifipass);
    delete config.network.networks[i].id;
  }
  uncommited();
}

var formData = new FormData();

function inProgress(callback) {
	$("body").load("masterclock.html #progresscontent", function(responseTxt, statusTxt, xhr) {
		if (statusTxt === "success") {
			$(".progress").css("height", "40");
			$(".progress").css("font-size", "xx-large");
			var i = 0;
			var prg = setInterval(function() {
				$(".progress-bar").css("width", i + "%").attr("aria-valuenow", i).html(i + "%");
				i++;
				if (i === 101) {
					clearInterval(prg);
					var a = document.createElement("a");
					//a.href = "http://" + window.location.host
					a.href = "http://" + config.general.hostnm + ".local";
					a.innerText = "Try to reconnect ESP";
					document.getElementById("reconnect").appendChild(a);
					document.getElementById("reconnect").style.display = "block";
					document.getElementById("updateprog").className = "progress-bar progress-bar-success";
					document.getElementById("updateprog").innerHTML = "Completed";
				}
//			}, 500);
			}, 250);
			switch (callback) {
				case "upload":
					$.ajax({
						url: "/update",
						type: "POST",
						data: formData,
						processData: false,
						contentType: false
					});
					break;
				case "commit":
					sendMessage(JSON.stringify(config));
					break;
				case "destroy":
					sendMessage("{\"command\":\"destroy\"}");
					break;
				case "restart":
					sendMessage("{\"command\":\"restart\"}");
					break;
				default:
					break;
			}
		}
	}).hide().fadeIn();
}

function commit() {
	inProgress("commit");
}


function handleDHCP(ntw) {
	//if (parseInt(document.querySelector("input[name=\"dhcpenabled\"]:checked").value) === 0) {
	if (ntw.dhcp === 0) {
	  $(':radio[name="dhcpenabled"][value=0]').prop('checked', true);
		document.getElementById("ipaddress").value = ntw.ipaddress;
		document.getElementById("subnet").value = ntw.subnet;
		document.getElementById("dnsadd").value = ntw.dnsadd;
		document.getElementById("gateway").value = ntw.gateway;
		$("#staticip1").slideDown();
		$("#staticip1").show();
		$("#staticip2").slideDown();
		$("#staticip2").show();
	} else {
	  $(':radio[name="dhcpenabled"][value=1]').prop('checked', true);
		$("#staticip2").slideUp();
		$("#staticip1").slideUp();
	}
}

function handleDHCP0()
{
  var ntw = netw;
  ntw.dhcp = 0;
  handleDHCP(ntw);
}

function handleDHCP1()
{
  var ntw = netw;
  ntw.dhcp = 1;
  handleDHCP(ntw);
}

function formatDate(date, format) {
    var map = {
        mm: String(date.getMonth() + 1).padStart(2, '0'),
        dd: String(date.getDate()).padStart(2, '0'),
        yyyy: String(date.getFullYear()).padStart(4, '0')
    };

    return format.replace(/mm|dd|yyyy/gi, matched => map[matched]);
}

function GetFormatedDate(date, format) {
	format.replace('mm', date.getMonth() + 1)
    .replace('yyyy', date.getFullYear())
	.replace('dd', date.getDate());
	return format;
}


function listnetwork() {
	$('#apssid').val(config.network.apssid);
  $('#apaddress').val(config.network.apaddress);
  $('#apsubnet').val(config.network.apsubnet);
  
  var netdata = JSON.parse(JSON.stringify(config.network.networks));

  for (i = 0; i < netdata.length; i++) {
    netdata[i].wifipass=atob(netdata[i].wifipass);
    netdata[i].id = i;
  }
    initNetwTable(netdata);
}

function getFormat()
{
  var select = document.getElementById("dateformat");
	var selected = select.options[select.selectedIndex];
	var value = selected.value;
}

function drawAnalog(cx, rds, tim, sec)
{
    drawFace(cx, rds);
    drawNumbers(cx, rds);
    drawTime(cx, rds, tim, sec);
}

function changeSLmode()
{
  var border="4px solid #FF0000";
  var bckgrnd="#FFFFFF";
    switch(sl_mode) {
  case 0://stopped
    $("#slstart").prop("disabled",false);
    $("#slstop").prop("disabled",true);
    $("#slwait").prop("disabled",false);
    $("#slaccc_up").prop("disabled",false);
    $("#evenvolt").prop("disabled",false);
    $("#oddvolt").prop("disabled",false);
    $(".slbtn").prop("disabled",false);
//    border="4px solid #FF0000";
    border="4px solid #C90000";
    break;
  case 1://waiting
    $("#slstart").prop("disabled",true);
    $("#slstop").prop("disabled",false);
    $("#slwait").prop("disabled",true);
    $("#slaccc_up").prop("disabled",true);
    $("#evenvolt").prop("disabled",true);
    $("#oddvolt").prop("disabled",true);
    $(".slbtn").prop("disabled",true);
//    border="4px solid #FFA500";
//    border="4px solid #FDA600";
    border="4px solid #800080";
    break;
  case 2://accelerated catch-up
    $("#slstart").prop("disabled",true);
    $("#slstop").prop("disabled",false);
    $("#slwait").prop("disabled",true);
    $("#slaccc_up").prop("disabled",true);
    $("#evenvolt").prop("disabled",true);
    $("#oddvolt").prop("disabled",true);
    $(".slbtn").prop("disabled",true);
//    border="4px solid #0000CD";
    border="4px solid #0038FF";
    break;
  case 3://running
    $("#slstart").prop("disabled",true);
    $("#slstop").prop("disabled",false);
    $("#slwait").prop("disabled",true);
    $("#slaccc_up").prop("disabled",true);
    $("#evenvolt").prop("disabled",true);
    $("#oddvolt").prop("disabled",true);
    $(".slbtn").prop("disabled",true);
//    border="4px solid #228B22";
    border="4px solid #32AE00";
    break;
  case 4://even voltage
    $("#slstart").prop("disabled",true);
    $("#slstop").prop("disabled",false);
    $("#slwait").prop("disabled",true);
    $("#slaccc_up").prop("disabled",true);
    $("#evenvolt").prop("disabled",true);
    $("#oddvolt").prop("disabled",false);
    $(".slbtn").prop("disabled",true);
//    border="4px solid #FF6347";
//    bckgrnd="#FF6347";
    border="4px solid #FFD700";
    bckgrnd="#FFD700";
    break;
  case 5://odd voltage
    $("#slstart").prop("disabled",true);
    $("#slstop").prop("disabled",false);
    $("#slwait").prop("disabled",true);
    $("#slaccc_up").prop("disabled",true);
    $("#evenvolt").prop("disabled",false);
    $("#oddvolt").prop("disabled",true);
    $(".slbtn").prop("disabled",true);
//    border="4px solid #FF6347";
//    bckgrnd="#FF6347";
    border="4px solid #FF9090";
    bckgrnd="#FF9090";
    break;
  default:
    // code block
    break;
 }
 $("#slstate").css({"border": border,"background":bckgrnd});
 $("#slstate").html(SL_MODES[sl_mode]);
}

async function listcontrol() {
  canvas2 = await waitForElementToExist('#canvas2');
  canvas2.style.position = 'relative';
  canvas2.style.top = "5px";
  ctx2 = canvas2.getContext("2d");
  canvas = await waitForElementToExist('#canvas');
  canvas.style.position = 'relative';
  canvas.style.top = "5px";
  ctx = canvas.getContext("2d");
  if (config.clock.cycle===12)
  {
    $('#canvasparent').css("height","250px");
    canvas2.width = "200";
    canvas2.height = "200";
    radius2 = canvas2.height / 2;
    ctx2.translate(radius2, radius2);
    radius2 = radius2 * 0.90;

    canvas.width = "200";
    canvas.height = "200";
    radius = canvas.height / 2;
    ctx.translate(radius, radius);
    radius = radius * 0.90;
  }
  else
  {
    $('#canvasparent').css("height","130px");
    canvas2.width = "455";
    canvas2.height = "86";
    canvas.width = "455";
    canvas.height = "86";
  }
  slclock();
  changeSLmode();
}

function slmode(mode)
{
  sendMessage("{\"command\":\"slmode\",\"mode\":"+mode+",\"slhour\":"+sl_hour+",\"slmin\":"+sl_min+"}");
}

function update_control()
{
  slclock();
  changeSLmode();
}

function limitTable(tbl, limit)
{
   $(".footable-add").prop("disabled", tbl.rows.all.length>=limit);
}


function free(array, start) {
  array.sort(function(a,b){return b.id - a.id});
  array.every(function (a) {
    if (start === a.id) {
      start = a.id + 1;
      return true;
      }
  });
  return start;
}

function readNetwTable() {
    var netwarr = [];
    var ft = FooTable.get("#netwtable");
    $.each(ft.rows.all, function (i, row) {
        v = row.val();
        var vls = {
            location: v.location,
            wifibssid: v.wifibssid,
            wifipass: v.wifipass,
            ssid: v.ssid,
            dhcp: v.dhcp,
            ipaddress: v.ipaddress,
            subnet: v.subnet,
            dnsadd: v.dnsadd,
            gateway: v.gateway,
            id: v.id
        };
        netwarr.push(vls);
    });
    return netwarr;
}

function initNetwTable(vals) {
    jQuery(function ($) {
        var $modal = $("#editor-modal2"),
            $editor = $("#editor2"),
            $editorTitle = $("#editor-title2"),
            ft = window.FooTable.init("#netwtable", {
                columns: [
                {
                    "name": "id",
                    "title": "ID",
                    "type": "number",
                    "visible": false
                },
                {
                    "name": "location",
                    "title": "Location",
                    "type": "text"
                },
                {
                    "name": "ssid",
                    "title": "SSID",
                    "type": "text"
                },
                {
                    "name": "wifibssid",
                    "title": "BSSID",
                    "type": "text"
                },
                {
                    "name": "wifipass",
                    "title": "Password",
                    "type": "text",
                    "visible": false
                },
                {
                    "name": "dhcp",
                    "title": "DHCP",
                    "type": "number"
                },
                {
                    "name": "ipaddress",
                    "title": "IP Address",
                    "type": "text",
                    "visible": false
                },
                {
                    "name": "subnet",
                    "title": "Mask",
                    "type": "text",
                    "visible": false
                },
                {
                    "name": "dnsadd",
                    "title": "DNS",
                    "type": "text",
                    "visible": false
                },
                {
                    "name": "gateway",
                    "title": "Gateway",
                    "type": "text",
                    "visible": false
                },
                ],
                rows: vals,
                editing: {
                    showText: "<span class=\"fooicon fooicon-pencil\" aria-hidden=\"true\"></span> Edit Networks",
                    addText: "New Network",
                    addRow: function () {                                                
                        $editor[0].reset();
                        $editor.find("#staticip1").css('display','none');           //reset visibility
                        $editor.find("#staticip2").css('display','none');           //reset visibility
                        $editor.find("#inputtohide").css('display','block');        //reset visibility
                        $editor.find("#ssid").css('display', 'none');               //reset visibility
                        $editorTitle.text("Add a new Network");
                        $editor.find("#scanb").css('display', 'block');             //enable Scan button
                        $editor.find("#scanb").html("Scan");                        //reset text
                        $modal.modal("show");
                    },
                    editRow: function (row) {
                        $editor.find("#inputtohide").css('display','block');            //reset visibility
                        $editor.find("#ssid").css('display', 'none');                   //reset visibility
                        //$(':radio[name="dhcpenabled"][value=1]').prop('checked', true);
                        var values = row.val();
                        $editor.find("#location").val(values.location);
                        $editor.find("#inputtohide").val(values.ssid);
                        $editor.find("#wifibssid").val(values.wifibssid);
                        $editor.find("#wifipass").val(values.wifipass);
	                      $editor.find("#hideBSSID").css('display', 'block');
	                      $editor.find("#scanb").css('display', 'block');
	                      $editor.find("#dhcp").css('display', 'block');
                        handleDHCP(values);
                        $modal.data("row", row);
                        $editorTitle.text("Edit Network # " + values.location);
                        $modal.modal("show");
                    },
                    deleteRow: function (row) {
                        var loc = row.value.location;
                        if (confirm("This will remove network \"" + loc + "\" from database. Are you sure?")) {
                            //var jsontosend = "{\"location\":\"" + loc + "\",\"command\":\"remove\"}";
                            //sendMessage(jsontosend);
                            row.delete();
                            limitTable(ft, netwmax);
                        }
                    }
                },
            });
        $editor.on("submit", function (e) {
  var dhcp;
	var ipaddr;
	var subn;
	var dnsadd;
	var gatw;
	var ssid="";
	if (parseInt(document.querySelector("input[name=\"dhcpenabled\"]:checked").value) === 0) {
		dhcp = 0;
		if (!checkOctects("ipaddress")) {
			return;
		}
		if (!checkOctects("subnet")) {
			return;
		}
		if (!checkOctects("dnsadd")) {
			return;
		}
		if (!checkOctects("gateway")) {
			return;
		}
		ipaddr = $editor.find("#ipaddress").val();
		subn = $editor.find("#subnet").val();
		dnsadd = $editor.find("#dnsadd").val();
		gatw = $editor.find("#gateway").val();
	} else {
		dhcp = 1;
		ipaddr = "";
		subn = "";
		dnsadd = "";
		gatw = "";
	}
      var inp = $('#inputtohide');
    	if (!inp.is(':visible')) 
    	{
	    	var b = document.getElementById("ssid");
		    ssid = b.options[b.selectedIndex].value
		    inp.prop('required',false);
	    }
	    else 
	    {
		    ssid = document.getElementById("inputtohide").value;
		    inp.prop('required',true);
	    }  
            if (this.checkValidity && !this.checkValidity()) {
                return;
            }
            var row = $modal.data("row");
            e.preventDefault();
            var values = {
                location: $editor.find("#location").val(),
                wifibssid: $editor.find("#wifibssid").val(),
                wifipass: $editor.find("#wifipass").val(),
                ssid: ssid,
                dhcp: dhcp,
                ipaddress: ipaddr,
                subnet: subn,
                dnsadd: dnsadd,
                gateway: gatw
            };
            if (row instanceof window.FooTable.Row) {
                values.id=row.val().id;
                row.delete();
                ft.rows.add(values);
            } else {
                var tmparr = readNetwTable();
                values.id = free(tmparr,0);
                ft.rows.add(values);
            }
            $modal.modal("hide");
            limitTable(ft, netwmax);
            var sorting = ft.use(FooTable.Sorting);
            sorting._sort(0, 0);        });
        limitTable(ft, netwmax);
    });
}

function listgeneral() {
	document.getElementById("adminpwd").value = atob(config.general.psswd);
	document.getElementById("hostname").value = config.general.hostnm;
}

function listBSSID() {
	var select = document.getElementById("ssid");
	document.getElementById("wifibssid").value = select.options[select.selectedIndex].bssidvalue;
}

function listSSID(obj) {
	var select = document.getElementById("ssid");
	$("#ssid").children().remove();
	for (var i = 0; i < obj.list.length; i++) {
		var x = parseInt(obj.list[i].rssi);
		var percentage = Math.min(Math.max(2 * (x + 100), 0), 100);
		var opt = document.createElement("option");
		opt.value = obj.list[i].ssid;
		opt.bssidvalue = obj.list[i].bssid;
		opt.innerHTML = obj.list[i].ssid + "   (Signal Strength: " + percentage + "% )";
		select.appendChild(opt);
	}
	document.getElementById("scanb").innerHTML = "Re-Scan";
	listBSSID();
}

function scanWifi() {
	sendMessage("{\"command\":\"scan\"}");
	document.getElementById("scanb").innerHTML = "...";
	document.getElementById("inputtohide").style.display = "none";
	var node = document.getElementById("ssid");
	node.style.display = "inline";
	while (node.hasChildNodes()) {
		node.removeChild(node.lastChild);
	}
}

function isVisible(e) {
  if (!e){return false;}
	return !!(e.offsetWidth || e.offsetHeight || e.getBoundingClientRect().Width);
}


function colorStatusbar(ref) {
	var percentage = ref.style.width.slice(0, -1);
	if (percentage > 50) {
		ref.className = "progress-bar progress-bar-success";
	} else if (percentage > 25) {
		ref.className = "progress-bar progress-bar-warning";
	} else {
		ref.class = "progress-bar progress-bar-danger";
	}
}

async function listStats() {
	version = ajaxobj.version;
	var chipelement = await waitForElementToExist('#chip');
	chipelement.innerHTML = ajaxobj.chipid;
	document.getElementById("model").innerHTML = ajaxobj.chipmodel;
	document.getElementById("cpu").innerHTML = ajaxobj.cpu + " Mhz";
	document.getElementById("uptime").innerHTML = ajaxobj.uptime;
	document.getElementById("heap").innerHTML = ajaxobj.heap + " Bytes";
	var totalheap = ajaxobj.totalheap;
	document.getElementById("heap").style.width = (ajaxobj.heap * 100) / totalheap + "%";
	colorStatusbar(document.getElementById("heap"));
	document.getElementById("flash").innerHTML = (ajaxobj.partsize-ajaxobj.sketchsize) + " Bytes";
	document.getElementById("flash").style.width = ((ajaxobj.partsize-ajaxobj.sketchsize) * 100) / ajaxobj.partsize + "%";
	colorStatusbar(document.getElementById("flash"));
	document.getElementById("spiffs").innerHTML = ajaxobj.availspiffs + " Bytes";
	document.getElementById("spiffs").style.width = (ajaxobj.availspiffs * 100) / ajaxobj.spiffssize + "%";
	colorStatusbar(document.getElementById("spiffs"));
	document.getElementById("ssidstat").innerHTML = ajaxobj.ssid;
	document.getElementById("ip").innerHTML = ajaxobj.ip;
	document.getElementById("gate").innerHTML = ajaxobj.gateway;
	document.getElementById("mask").innerHTML = ajaxobj.netmask;
	document.getElementById("dns").innerHTML = ajaxobj.dns;
	document.getElementById("mac").innerHTML = ajaxobj.mac;
	document.getElementById("sver").innerText = version;
	$("#mainver").text(version);
}

function getContent(contentname) {
	$("#dismiss").click();
	$(".overlay").fadeOut().promise().done(function() {
		var content = $(contentname).html();
		$("#ajaxcontent").html(content).promise().done(function() {
			switch (contentname) {
				case "#statuscontent":
					break;
				case "#backupcontent":
					break;
				case "#ntpcontent":
					listntp();
					break;
				case "#generalcontent":
					listgeneral();
					break;
				case "#controlcontent":
					break;
				case "#clockcontent":
					listclock();
					break;
				case "#hardwarecontent":
					listhardware();
					break;
				case "#networkcontent":
					listnetwork();
					break;
				default:
					break;
			}
			$("[data-toggle=\"popover\"]").popover({
				container: "body"
			});
			$(this).hide().fadeIn();
		});
	});
}

function restoreSet() {
	var input = document.getElementById("restoreSet");
	var reader = new FileReader();
	if ("files" in input) {
		if (input.files.length === 0) {
			alert("You did not select file to restore!");
		} else {
			reader.onload = function() {
				var json;
				try {
					json = JSON.parse(reader.result);
				} catch (e) {
					alert("Not a valid backup file!");
					return;
				}
				if (json.command === "configfile") {
					var x = confirm("File seems to be valid, do you wish to continue?");
					if (x) {
						config = json;
						uncommited();
					}
				}
			};
			reader.readAsText(input.files[0]);
		}
	}
}

function waitForElementToExist(selector) {
  return new Promise(resolve => {
    if (document.querySelector(selector)) {
      return resolve(document.querySelector(selector));
    }

    var observer = new MutationObserver(() => {
      if (document.querySelector(selector)) {
        resolve(document.querySelector(selector));
        observer.disconnect();
      }
    });

    observer.observe(document.body, {
      subtree: true,
      childList: true,
    });
  });
}


function twoDigits(value) {
	if (value < 10) {
		return "0" + value;
	}
	return value;
}

function restartESP() {
	inProgress("restart");
}

function getTime(utcSeconds, tzoffset)
{
  var now = new Date(0); // The 0 there is the key, which sets the date to the epoch
  var devTime = Math.floor(utcSeconds + (tzoffset * 60));
  now.setUTCSeconds(devTime);
  return String(now.getUTCHours()).padStart(2, '0') + String(now.getUTCMinutes()).padStart(2, '0') + String(now.getUTCSeconds()).padStart(2, '0');

}

function socketMessageListener(evt) {
    var obj;
    try {
        obj = JSON.parse(evt.data);
    } catch (e) {
      console.log("No JSON: ",evt.data);
        return; // error in the above string (in this case, yes)!
    }
    // if no error, we can now keep using "obj"
	if (obj.hasOwnProperty("command")) {
		switch (obj.command) {
			case "status":
				ajaxobj = obj;
				console.log(JSON.stringify(obj)); //keep permanently!
				getContent("#statuscontent");
        $("li.active").removeClass("active");
        $("#status").parent().addClass("active");
        listStats();
				break;
			case "slaveline":
  			  if (obj.hasOwnProperty("slmin"))
  			  {
  			    sl_min=obj.slmin;
  			  }
  			  if (obj.hasOwnProperty("slhour"))
  			  {
  			    sl_hour=obj.slhour;
  			  }
  			  if (obj.hasOwnProperty("sl_mode"))
  			  {
				    sl_mode=obj.sl_mode;
  			  }
				getContent("#controlcontent");
        $("li.active").removeClass("active");
        $("#control").parent().addClass("active");
				listcontrol();
				break;
			case "gettime":
				utcSeconds = obj.epoch;
				tzoffset = obj.tzoffset;
				var utc = document.getElementById("utc");
				var canvas2 = document.getElementById("canvas2");
    	  if (isVisible(utc))
      	{
				deviceTime();
				browserTime();
      	}
      	else if (isVisible(canvas2))
      	{
      	  newtime=getTime(utcSeconds, tzoffset);
      	  updateTime(newtime);
      	}
				break;
			case "ssidlist":
				listSSID(obj);
				break;
			case "webconfig":
  			  if (obj.hasOwnProperty("reservedgpios"))
  			  {
  			    RESERVEDGPIOS=obj.reservedgpios;
  			  }
  			  if (obj.hasOwnProperty("ota"))
  			  {
            if (obj.ota)
            {
              $("#update").css('display','block');
            }
  			  }				
				break;
			case "configfile":
				config = obj;
  			  break;
			case "heartbeat":
			  console.log(JSON.stringify(obj));
        missed_heartbeats = 0;
				break;
			case "slmode":
  			  if (obj.hasOwnProperty("slmin"))
  			  {
  			    sl_min=obj.slmin;
  			  }
  			  if (obj.hasOwnProperty("slhour"))
  			  {
  			    sl_hour=obj.slhour;
  			  }
  			  if (obj.hasOwnProperty("mode"))
  			  {
  			    sl_mode=obj.mode;
  			    update_control();
  			  }
				break;
			case "slimpuls":
  			  if (obj.hasOwnProperty("slmin"))
  			  {
  			    sl_min=obj.slmin;
  			  }
  			  if (obj.hasOwnProperty("slhour"))
  			  {
  			    sl_hour=obj.slhour;
  			  }
				  var canvas2 = document.getElementById("canvas2");
          if (isVisible(canvas2))
      	  {
      	    slclock();
      	  }
				break;
			default:
				break;
		}
	}
	if (obj.hasOwnProperty("resultof")) {
		switch (obj.resultof) {
			default: break;
		}
	}
}

function compareDestroy() {
	if (config.general.hostnm === document.getElementById("compare").value) {
		$("#destroybtn").prop("disabled", false);
	} else {
		$("#destroybtn").prop("disabled", true);
	}
}

function destroy() {
	inProgress("destroy");
}

$("#settings").on("click", function() {
  var hw = document.getElementById("hardware");
  if (!isVisible(hw))
  {
    $("li.active").removeClass("active");
  }
});

$("#dismiss, .overlay").on("click", function() {
	$("#sidebar").removeClass("active");
	$(".overlay").fadeOut();
});

$("#sidebarCollapse").on("click", function() {
	$("#sidebar").addClass("active");
	$(".overlay").fadeIn();
	$(".collapse.in").toggleClass("in");
	$("a[aria-expanded=true]").attr("aria-expanded", "false"); //mozna prop misto attr ?
});

$("#status").click(function() {
	sendMessage("{\"command\":\"status\"}");
	return false;
});

$("#network").on("click", (function() {
	getContent("#networkcontent");
	return false;
}));

$("#hardware").click(function() {
  sendMessage("{\"command\":\"hw\"}");
	getContent("#hardwarecontent");
	return false;
});

$("#general").click(function() {
	getContent("#generalcontent");
	return false;
});

$("#control").click(function() {
  sendMessage("{\"command\":\"slaveline\"}");
	return false;
});

$("#clock").click(function() {
	getContent("#clockcontent");
	return false;
});


$("#ntp").click(function() {
	getContent("#ntpcontent");
	return false;
});

$("#backup").click(function() {
	getContent("#backupcontent");
	return false;
});

$("#reset").click(function() {
	$("#destroy").modal("show");
	return false;
});

$("#updatea").click(function() {
	$("#updated").modal("show");
	getLatestReleaseInfo();
	return false;
});

$(".noimp").on("click", function() {
	$("#noimp").modal("show");
});

var xDown = null;
var yDown = null;

function handleTouchStart(evt) {
	xDown = evt.touches[0].clientX;
	yDown = evt.touches[0].clientY;
}

function handleTouchMove(evt) {
	if (!xDown || !yDown) {
		return;
	}

	var xUp = evt.touches[0].clientX;
	var yUp = evt.touches[0].clientY;

	var xDiff = xDown - xUp;
	var yDiff = yDown - yUp;

	if (Math.abs(xDiff) > Math.abs(yDiff)) { /*most significant*/
		if (xDiff > 0) {
			$("#dismiss").click();
		} else {
			$("#sidebarCollapse").click();
			/* right swipe */
		}
	} else {
		if (yDiff > 0) {
			/* up swipe */
		} else {
			/* down swipe */
		}
	}
	/* reset values */
	xDown = null;
	yDown = null;
}

function logout() {
  console.log("function logout ...");
	jQuery.ajax({
			type: "GET",
			url: "/login",
			async: false,
			username: "logmeout",
			password: "logmeout",
		})
		.done(function() {
			// If we don"t get an error, we actually got an error as we expect an 401!
		})
		.fail(function() {
			// We expect to get an 401 Unauthorized error! In this case we are successfully
			// logged out and we redirect the user.
			document.location = "index.html";
		});
	return false;
}

// Make the function wait until the connection is made...
function waitForSocketConnection(socket, callback){
    setTimeout(
        function () {
            if (socket.readyState === 1) {
                if (callback != null){
                    callback();
                }
            } else {
                waitForSocketConnection(socket, callback);
            }

        }, 5); // wait 5 milisecond for the connection...
}

function sendMessage(msg){
    // Wait until the state of the socket is not ready and send the message when it is...
    waitForSocketConnection(websock, function(){
        websock.send(msg);
    });
}

function connectWS() {
  console.log("function connectWS()");
	if (wsConnectionPresent) {
		return;
	}
	if (window.location.protocol === "https:") {
		wsUri = "wss://" + window.location.hostname + ":" + window.location.port + "/ws";
	} else if (window.location.protocol === "file:" || ["0.0.0.0", "localhost", "127.0.0.1"].includes(window.location.hostname)) {
		wsUri = "ws://localhost:8080/ws";
	}
	websock = null;
	websock = new WebSocket(wsUri);
	websock.addEventListener("message", socketMessageListener);

websock.onopen = function(evt) {
    // ...
    // other code which has to be executed after the client
    // connected successfully through the websocket
    // ...
    
		if (!gotInitialData) {
			sendMessage("{\"command\":\"getconf\"}");
			gotInitialData = true;
		}
    if (heartbeat_interval === null) {
        missed_heartbeats = 0;
        heartbeat_interval = setInterval(function() {
            try {
                missed_heartbeats++;
                if (missed_heartbeats >= 3)
                    throw new Error("Too many missed heartbeats.");
            }
            catch(e) {
                clearInterval(heartbeat_interval);
                heartbeat_interval = null;
                console.warn("Closing connection. Reason: " + e.message);
                getContent("#emptycontent");
                $("#ws-connection-status").slideDown();
                websock.close();
            }
        }, 5000);
    }
    $("#ws-connection-status").slideUp(1000, function() {
     sendMessage("{\"command\":\"status\"}");
    });
};

	websock.onclose = function(evt) {
	  console.log("websock.onclose");
	  websock = null;
	  gotInitialData = false;
	  heartbeat_interval = null
	  document.location = "index.html";
	};

}

function upload() {
	formData.append("bin", $("#binform")[0].files[0]);
	inProgress("upload");
}

function login() {
	if (document.getElementById("password").value === "neo") {
		$("#signin").modal("hide");
		connectWS();
	} else {
		var username = "admin";
		var password = document.getElementById("password").value;
		var url = "/login";
		var xhr = new XMLHttpRequest();
		xhr.open("get", url, true, username, password);
		xhr.onload = function(e) {
			if (xhr.readyState === 4) {
				if (xhr.status === 200) {
					$("#signin").modal("hide");
					connectWS();
				} else {
					alert("Incorrect password!");
				}
			}
		};
		xhr.send(null);
	}
}

function getLatestReleaseInfo() {
	$("#versionhead").text(version);
	$.getJSON("https://api.github.com/repos/Pako2/esp32_masterclock/releases/latest").done(function(release) {
		var asset = release.assets[0];
		var downloadCount = 0;
		for (var i = 0; i < release.assets.length; i++) {
			downloadCount += release.assets[i].download_count;
		}
		var oneHour = 60 * 60 * 1000;
		var oneDay = 24 * oneHour;
		var dateDiff = new Date() - new Date(release.published_at);
		var timeAgo;
		if (dateDiff < oneDay) {
			timeAgo = (dateDiff / oneHour).toFixed(1) + " hours ago";
		} else {
			timeAgo = (dateDiff / oneDay).toFixed(1) + " days ago";
		}

		var releaseInfo = release.name + " was updated " + timeAgo + " and downloaded " + downloadCount.toLocaleString() + " times.";

		$("#downloadupdate").attr("href", asset.browser_download_url); //mozna prop misto attr ?
		$("#releasehead").text(releaseInfo);
		$("#releasebody").text(release.body);
		$("#releaseinfo").fadeIn("slow");
	}).error(function() {
		$("#onlineupdate").html("<h5>Couldn't get release info. Are you connected to the Internet?</h5>");
	});
}

function allowUpload() {
	$("#upbtn").prop("disabled", false);
}

function start() {
	esp32masterclock = document.createElement("div");
	esp32masterclock.id = "mastercontent";
	esp32masterclock.style.display = "none";
	document.body.appendChild(esp32masterclock);
	$("#signin").on("shown.bs.modal", function() {
		$("#password").focus().select();
	});
	$("#mastercontent").load("masterclock.html", function(responseTxt, statusTxt, xhr) {
		if (statusTxt === "success") {
			$("#signin").modal({
				backdrop: "static",
				keyboard: false
			});
			$("[data-toggle=\"popover\"]").popover({
				container: "body"
			});
		}
	});
  
}

document.addEventListener("touchstart", handleTouchStart, false);
document.addEventListener("touchmove", handleTouchMove, false);
